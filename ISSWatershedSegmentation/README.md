# ISS DATA ANALYSIS
MatLab scripts used to extract Protein-Protein Binding Curves from FLIM and FLIM-HS Scans
## ISS Data Structure
The exported ISS data should be seperated in the following way. 
Scans for each well should be put into one global folder
Each global folder should contain the following subfolders : 
 - "Ch1" for acceptor intensity images
 - "Ch2" for donor intensity images
 - "tau" for fluorescence lifetime maps generated by the ISS software

## Running the script
## Step1_WatershedSegmentation
1- Open LoopThroughMultipleDataFolder.m
2- Manually add in the paths to that global folders created 
example:
list_of_folders = {'path_to_global_folder_1', 'path_to_global_folder_2', 'path_to_global_folder3'; 
3- Run Scripts 

The script will segment the donor intensity images and measure several parameters from all three images.
ROI level measurements will be saved into a CSV file "Raw_Measurements.csv" in each corresponding global folder


### Script Optimization For Your Dataset
The scripts presented here use multi-seed watershed segmentation to generate Regions of Interests (ROIs).
The segmentation parameters were optimized for mCerulean3-BclXL and mCerulean3-Bcl2. 
The parameters can be modified the imaged protein distribution varies from BclXL and Bcl2. 
Open ISSWatershedSegmentation.m and optimize the following parameters: 
- log_size is the size of Laplacian of Gaussian kernel. Larger kernels means convolution with more pixels 
- log_sigma is the standard deviation of the LoG and it controls the sharpness of blobs like features in the images
For proteins with consistent expression across the entire cell, consider using larger log_sigma values
- Pixel_threshold is the minimum size of small objects in the image. 

## Step2_data_binning
The next part of the scirpt is used to combine the ROI measurements and bin them to generate protein-protein binding curves.
Open LoopThroughDataToBin.m located in the Step2_data_binning folder. 
The scripts will also require you to provide paths to the measurement CSVs generated in the first step. 
Additionally, you will need to provide the script with path for untransfected cell scans. These are cells that only express the donor labeled proteins. These measurements will be used to estimate the fluorescence lifetime of the donor in the abscence of acceptor (non-binding lifetime) as well as the range of donor intensities used for the analysis. 
We determine this statistically using the donor intensity distriubtion and calculating the interval between 5%-95%. 
The thrshold parameters are saved as ch2_lower_thresh and ch2_upper_thresh. 
The script will identify the Raw_Measurements.CSV in each global folder and bin the data. 
ROIs with mean donor intensity below ch2_lower_thresh or above ch2_upper_thresh are excluded. 
Running the scripts will generate binned binding curves also located in the global folders. 
The binned results are saved CSV files named "Binned_Results.csv". 

## Script Optimization
Data binning is carried using the Acceptor:Donor ratio calcualted for each ROI. 
The size of bins used is also optimized for our experiment. 
Consider changing the bins to match your experimental conditions (Microscope settings and protein expression levels). 
To modify the bin sizes, open BinISSData.m located in Step2_data_binning folder. 
change the bins array 
